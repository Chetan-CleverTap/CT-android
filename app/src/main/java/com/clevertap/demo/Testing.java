package com.clevertap.demo;

import android.content.Context;
import android.net.Uri;
import android.os.Environment;
import android.util.Log;
import android.widget.Toast;

import org.json.JSONArray;
import org.json.JSONObject;

import java.io.File;
import java.io.FileOutputStream;
import java.io.InputStream;
import java.util.ArrayList;

public class Testing {

    public Testing(Context context, Uri uri) {
        Runnable r = () -> process(context, uri);
        new Thread(r).start();
    }
    void process(Context context,  Uri uri) {
        try {
            String[] list = {"paytm_phone", "recharge_transaction", "offline_transaction", "phone_no", "full_name", "state", "paytm_last_transaction_date", "device_os", "city", "first_name", "paytm_total_transaction_count", "mpin_set", "ct_is_test_user", "merchant_name", "app_version", "bank_account_linked", "saving_account_opened_date", "sign_up_date", "current_kyc_state", "minimum_kyc_completion_date", "wallet_type", "paytm_first_transaction_size", "kyc_gender", "full_kyc_completion_date", "basic_plus_kyc_completed", "basic_plus_completion_date", "current_kyc_state_expiring_date", "customer_age_bucket", "minimum_kyc_expiration_date", "latest_lang", "pin_code", "credit_score", "latest_open_date", "min_kyc_completed", "1st_cat", "1st_cat_lc", "paytmfirst_status", "OFFLINE_MERCHANT_last_transaction_date", "full_kyc_completed", "wallet_P2P_total_transaction_count", "bank_Outward_last_transaction_date", "recharge_last_transaction_date", "recharge_total_transaction_size", "recharge_utilities_mobile_prepaid_first_transaction_date", "wallet_P2P_last_transaction_date", "upi_p2p_in_last_transaction_date", "bank_SA_count_of_debit_txns", "offline_first_transaction_date", "recharge_utilities_mobile_prepaid_total_transaction_size", "bank_UPI_OUT_last_transaction_date", "bank_Inward_total_transaction_count", "upi_p2p_out_total_transaction_count", "bookings_total_transaction_size", "wallet_A2W_total_transaction_size", "bookings_movies_last_transaction_date", "bank_UPI_IN_last_transaction_date", "bookings_movies_total_transaction_size", "recharge_utilities_mobile_prepaid_total_transaction_count", "bookings_movies_total_transaction_count", "ONLINE_last_transaction_date", "wallet_A2W_DC_first_transaction_date", "bank_Outward_total_transaction_count", "wallet_A2W_UPI_last_transaction_date", "bookings_movies_first_transaction_date", "recharge_utilities_DTH_total_transaction_size", "wallet_A2W_first_transaction_date", "recharge_utilities_mobile_prepaid_self_recharge_last_transaction_date", "ONLINE_first_transaction_date", "bank_SA_total_transaction_count", "ONLINE_total_transaction_count", "recharge_utilities_mobile_postpaid_first_transaction_date", "recharge_utilities_mobile_postpaid_total_transaction_count", "recharge_utilities_DTH_total_transaction_count", "UPI_P2P_OUT_first_transaction_date", "ONLINE_total_transaction_size", "recharge_utilities_mobile_postpaid_total_transaction_size", "UPI_P2P_OUT_last_transaction_date", "gold_buy_last_transaction_date", "gold_buy_total_transaction_count", "wallet_A2W_DC_last_transaction_date", "upi_out_total_transaction_count", "offline_UPI_total_transaction_count", "bank_Inward_last_transaction_date", "wallet_BANK_P2B_total_transaction_size", "recharge_utilities_cable_total_transaction_count", "wallet_A2W_CC_last_transaction_date", "gold_buy_total_transaction_size", "gold_buy_first_transaction_date", "paytm_total_transaction_size", "upi_p2p_out_total_transaction_size", "wallet_A2W_last_transaction_date", "wallet_A2W_total_transaction_count", "wallet_A2W_UPI_first_transaction_date", "wallet_A2W_NB_total_transaction_size_last_month", "upi_out_first_transaction_date", "wallet_A2W_UPI_total_transaction_size_last_month", "wallet_A2W_NB_first_transaction_date", "paytmfirst_last_subscription_date", "wallet_A2W_DC_total_transaction_size_last_month", "wallet_BANK_P2B_total_transaction_count", "bookings_total_transaction_count", "offline_FOOD_total_transaction_count_30_days", "paytmfirst_subscription_expiry_date", "wallet_A2W_CC_first_transaction_date", "recharge_utilities_CreditCard_last_transaction_date", "bookings_train_last_transaction_date", "recharge_utilities_Fastag_total_transaction_count", "bookings_train_total_transaction_count", "recharge_utilities_CreditCard_first_transaction_date", "recharge_utilities_cylinderBooking_total_transaction_count", "bookings_FEE_last_transaction_date", "bookings_FEE_first_transaction_date", "bookings_FEE_total_transaction_count", "bookings_BUS_total_transaction_count", "bookings_BUS_total_transaction_size", "recharge_utilities_metro_first_transaction_date", "recharge_utilities_cylinderBooking_last_transaction_date", "bookings_BUS_last_transaction_date", "recharge_utilities_datacard_last_transaction_date", "recharge_utilities_CreditCard_total_transaction_count", "recharge_utilities_cylinderBooking_first_transaction_date", "wallet_A2W_CC_total_transaction_size_last_month", "recharge_utilities_GAS_total_transaction_count", "recharge_utilities_FT_first_transaction_date", "recharge_utilities_FT_total_transaction_count", "recharge_utilities_FT_last_transaction_date", "paytm_total_transaction_count_last_30_days", "recharge_utilities_mobile_postpaid_total_transaction_count_last_30_days", "super_user_id", "recharge_utilities_mobile_prepaid_total_transaction_count_last_30_days", "wallet_A2W_last_transaction_last_30_days", "category", "current_stage", "RU_EC_total_transaction_count_90_days", "online_user_with_txn_in_90_days", "PaytmMoney_signup_exists", "recharge_utilities_DTH_total_transaction_count_last_60_days", "RU_EC_total_transaction_count_30_days", "EDC_super_user_id_new", "recharge_utilities_MTC_last_transaction_operator", "PaytmMoney_state", "MINIAPPS_total_transaction_count", "PaytmMoney_ipo_applied", "ONLINE_total_transaction_count_60_days", "PaytmMoney_login_date", "recharge_utilites_rentpayment_cc_user_ever", "ONLINE_total_transaction_count_30_days", "RU_CYL_IVRS_last_booking_date", "ONLINE_TXN_MID_List", "ONLINE_TXN_MID_List_30_days", "paytm_first_active_points", "merchant_subcategory", "ONLINE_TXN_MID_List_60_days", "CONSUMERLENDING_postpaid_total_txn_amount_1_calendar_months", "CONSUMERLENDING_postpaid_authorized_limit", "CONSUMERLENDING_postpaid_available_limit", "3rd_cat", "2nd_cat", "CUSTOMERDEVICE_isPushNotificationDisabled", "recharge_utilities_DTH_last_transaction_size", "2nd_cat_lc", "merchant_type", "paytm_total_transaction_count_last_180_days", "paytm_total_transaction_count_last_90_days", "paytm_total_transaction_count_last_7_days", "bank_savings_account_scheme_codes", "paytm_total_transaction_count_last_60_days", "offline_all_total_transaction_count", "paytm_all_total_transaction_count_last_month", "paytm_all_total_transaction_count", "bank_FD_IMPULSE_booked_count", "bank_SA_count_of_debit_txns_via_UPI", "bank_SA_count_of_debit_txns_via_net_banking", "bank_PPBL_DC_transaction_count", "bank_SA_count_of_credit_txns", "bank_SA_count_of_debit_txns_via_UPI_30_days", "bank_SA_count_of_credit_txns_in_last_30_days", "bank_SA_count_of_debit_txns_via_net_banking_30_days", "CC_App_Rejected_Affluent", "CC_App_Rejected_Citi", "offline_all_txn_mid_list", "bookings_flights_total_transaction_count", "cir_pulled_report", "CC_App_Rejected_Mass", "online_all_txn_mid_list", "bookings_hotel_total_transaction_count", "bookings_international_flights_total_transaction_count", "customer_id_last_two_digits", "CC_Carded", "stage_start_date", "online_user_with_txn_in_60_days", "online_user_with_txn_in_30_days", "CREDITCARD_last_txn_date", "RU_MB_prepaid_last_transaction_size", "CREDITCARD_cardcount", "BANK_ADDMONEY_DC_last_transaction_date", "RU_EC_last_transaction_operator", "BANK_wallet_balance_bucket", "BANK_ADDMONEY_CC_last_transaction_date", "BANK_SA_last_add_money_via_UPI_txn_date", "RU_EC_last_transaction_date", "RU_MB_postpaid_last_transaction_size", "RU_CreditCard_last_transaction_size", "BANK_ADDMONEY_NB_last_transaction_date", "BANK_SA_added_money_via_debit_card_txn_amount", "BANK_SA_last_add_money_via_debit_card_txn_date", "BANK_SA_last_add_money_via_debit_card_txn_amount", "RU_RENT_total_transaction_count", "DND_PFCC", "paytm_push_reachability", "bank_debitCard_network_type", "bank_debitCard_order_date", "bank_debitCard_activation_date", "BANK_count_of_debit_transactions_via_debit_card", "recharge_utilities_MT_total_transaction_count_last_30_days", "recharge_utilities_mobile_postpaid_last_transaction_date", "RU_EC_first_transaction_date", "recharge_utilities_DTH_last_transaction_date", "recharge_utilities_mobile_prepaid_last_transaction_date", "recharge_utilities_DTH_total_transaction_count_last_180_days", "recharge_utilities_mobile_prepaid_total_transaction_count_last_180_days", "recharge_utilities_mobile_prepaid_total_transaction_count_last_90_days", "recharge_utilities_DTH_total_transaction_count_last_30_days", "RU_EC_total_transaction_count", "recharge_utilities_CreditCard_total_transaction_count_last_30_days", "recharge_utilities_MT_total_transaction_count_last_90_days", "recharge_utilities_mobile_postpaid_total_transaction_count_last_180_days", "recharge_utilities_mobile_postpaid_total_transaction_count_last_90_days", "recharge_utilities_MTC_total_transaction_count_last_90_days", "recharge_utilities_MTC_total_transaction_count_last_30_days", "recharge_utilities_Rentpayment_first_transaction_date", "recharge_utilities_Rentpayment_total_transaction_count_last_90_days", "recharge_utilities_cylinderBooking_total_transaction_count_last_60_days", "recharge_utilities_Rentpayment_last_transaction_date", "PaytmMoney_is_active", "recharge_utilities_Rentpayment_total_transaction_count_last_30_days", "PaytmMoney_optin_date", "PaytmMoney_first_funds_additon_date", "PaytmMoney_cash_equity_ir_verified_date", "PaytmMoney_IR_initiation_date", "PaytmMoney_total_traded_orders", "PaytmMoney_last_trade_date", "PaytmMoney_mf_total_amount", "PaytmMoney_etf_first_order_date", "PaytmMoney_fno_ir_verified_date", "recharge_utilities_MT_last_transaction_operator", "OVERALL_top4_total_transaction_count", "push_opt_out_paytm", "paytm_first_points_expired", "recharge_and_utilities_cylinderbooking_last_used_operator", "paytm_first_last_points_issuance_date", "paytm_first_expiring_points", "RU_EC_total_transaction_new_count_30_days", "paytm_last_30_days_active_users", "Offline_merchant_transaction_subCategory", "Estimated_gender", "Offline_merchant_transaction_category", "Date_user_last_seen_on_Paytm_ecosystem", "ONLINE_TXN_MID_List_12_calendar_months", "ONLINE_PAYEE_VPA_List_new", "ONLINE_PAYEE_VPA_List_new_60_days", "ONLINE_TXN_MID_List_new_60_days", "ONLINE_TXN_MID_List_new", "ONLINE_PAYEE_VPA_List_new_12_calendar_months", "ONLINE_TXN_MID_List_new_30_days", "ONLINE_PAYEE_VPA_List_new_30_days", "ONLINE_TXN_MID_List_new_12_calendar_months", "CONSUMERLENDING_postpaid_sub_product_type", "CONSUMERLENDING_postpaid_account_creation_date", "CONSUMERLENDING_postpaid_conv_fee", "CONSUMERLENDING_postpaid_total_txn_amount", "RU_DTH_preferable_transaction_operator", "BANK_WALLET_min_enable_date", "CONSUMERLENDING_postpaid_account_status", "profile_merchant_isMerchant", "bonus_active_points", "3rd_cat_lc", "PAYTM_first_transaction_date_new", "PAYTM_last_transaction_date_new", "Lending_DND_HDFC_19Nov", "Postpaid Signup Current Offers", "MINIAPPS_online_transport_user_count_30_days", "MINIAPPS_online_retailshopping_user_count_30_days", "merchant_channel", "MINIAPPS_offline_healthcare_user_count_30_days", "MINIAPPS_offline_food_user_count_30_days", "merchant_state", "MINIAPPS_online_healthcare_user_count_30_days", "merchant_category", "P4B_app_last_login_date", "is_customer_logged_out_flag", "CONSUMERLENDING_postpaid_total_transaction_count_1_calendar_months", "ONLINE_TXN_MID_List_new_90_days", "PROMOTION_Latest_ScratchcardIssueDate_last_scratchCard_issuedate", "PSC_deals_SC_unscratched", "PSC_deals_SC_scratched_30days", "PSC_campaign_card_scratched_30days", "PSC_deals_SC_issued_30days", "PSC_campaign_card_scratched_7days", "PSC_campaign_card_scratched_this_month", "PSC_campaign_card_scratched_new_30days", "Flights_Total_Transaction_Count_in_last_90_Days", "Flights_Total_Transaction_Count_in_last_60_Days", "Fastag_last_issuance_date", "Flights_Overall_Total_Transaction_Count", "Fastag_passenger_tag_count", "Flights_Last_Transaction_Date", "Fastag_last_closure_date", "Fastag_tag_count", "Flights_International_Last_Transaction_Date", "permission_sms_read_consent", "permission_whatsapp_consent", "LOAN_entry_date", "customer_id_paytm", "RU_DTH_last_transaction_operator", "Email_09_02_2022", "PaytmMovie_showtime_moviename", "PaytmMovie_seatmap_cinemaname", "Fastag_total_transaction_count_60_days", "Fastag_total_transaction_count_30_days", "Fastag_total_transaction_amount_180_days", "Fastag_Issuance_status", "Fastag_Current_Status", "Fastag_total_transaction_count_180_days", "RU_Fastag_last_toll_transaction_Date", "Fastag_total_transaction_count_90_days", "Postpaid transaction offers", "AutoPay_Enabled_Services", "CLPP_Favourite_offline_merchant", "release_version", "PaytmMoney_investment_readiness_status", "PaytmMoney_sign_up_date", "PaytmMoney_accnt_creation_date", "PaytmMoney_kyc_status", "PaytmMoney_is_email_verified", "FOM_1", "FOM_2", "FOM_3", "BFOM_1", "BFOM_2", "RU_citybus_total_transaction_amount", "RU_citybus_last_transaction_date", "RU_citybus_total_transaction_count", "RU_citybus_first_transaction_date", "PaytmMoney_equity_optin_date", "PaytmMoney_equity_investment_ready_date", "PaytmMoney_equity_last_investment_date", "CC_HDFC_Carded", "Total_pg_transactions_count", "pp_3p_merchant", "PaytmMoney_esign_completed", "PaytmMoney_can_receive_email", "PaytmMoney_mf_investment_ready_date", "PaytmMoney_FnO_activation_date", "PaytmMoney_FnO_last_investment_date", "PP_Email", "MEDICAL_slots_booked", "MEDICAL_healthId_created", "MEDICAL_pharmacy_flag", "MEDICAL_documents_uploaded", "MEDICAL_insurance_flag", "MEDICAL_total_pg_transactions", "MEDICAL_certificate_downloaded", "MEDICAL_pathology_lab_flag", "MEDICAL_doctors_and_clinic_flag", "Spam_data_6May", "INSURANCE_3p_payment_mode", "INSURANCE_3p_txns_count_12_calendar_months", "INSURANCE_3p_last_txn_date", "POSTPAID_decile_score", "Referral_success_total_transaction_count", "Dynamic_CCF", "ReferralCategory_user_rating", "Signup_date_anniversary", "customer_age", "CONSUMERLENDING_postpaid_lender_name", "app_language", "BANK_account_closed", "eRupipref", "Personal_Loan_Risk_Whitelist", "fastag_recharge_circle", "0108_loan_amount_lowrisk", "RU_3p_Opearators", "ReferralCategory_total_transaction_count", "CONSUMERLENDING_postpaid_CST_account_closure_request_date", "WA_notification_received_status_last_10_days", "paytmmoney_eq_subscription_plan", "PaytmMoney_last_funds_addition_date", "PaytmMoney_mf_first_invested_date_new", "AM_overall_MTD_agg_GMV", "AM_overall_last_month_agg_GMV", "AM_OnPaytm_usingCC_MTD_agg_GMV", "SpendMoney_overall_last_month_agg_GMV", "SpendMoney_overall_MTD_agg_GMV", "AM_OnPaytm_usingCC_last_month_agg_GMV", "paytm_last_push_open_date", "CONSUMERLENDING_Postpaid_CST_account_closure_reason_CF_request_date", "BANK_mapper_status", "BANK_next_due_date", "Loans_promo_dropoff14Dec", "CIRRTO_offer_amt_postpaid", "PL_CIR_Amont", "PL_CIR_Offer", "PaytmMoney_PaytmMini_Retention_Info", "CONSUMERLENDING_postpaid_upgraded_limit", "LOAN_tnc_accepted_date", "Electricity_promo_dropoff_1stJan", "CONSUMERLENDING_postpaid_upgrade_offer_expiry", "CONSUMERLENDING_postpaid_upgrade_accepted", "cirrto_offer_amt_postpaid_p2", "ccbp_amount_dropoff", "DEALS_date_of_onboarding", "GLOBAL_CLUSTER", "maskId", "PFG_Bonus_Balance", "BANK_SA_amount_avg_last_30_days", "BANK_Paytm_Passcode_status", "MCA_WL_Type", "MCA_NoOfTimesWL", "MCA_ROI_Monthly", "MCA_Loan_Amount", "MCA_PF", "MCA_Lender_name", "MCA_OE_state", "MCA_Language", "Rent_last_month_agg_GMV", "Rent_MTD_agg_GMV", "OVERALL_failed_transactions_count_7_days", "recharge_utilities_EducationFees_last_transaction_date", "LOAN_max_amount", "OVERALL_failed_transactions_count_90_days", "OVERALL_failed_transactions_count_60_days", "OVERALL_failed_transactions_count_30_days", "deal_seeker_rank", "digital_savvy_rank", "shopoholic_rank", "propensity_score_wallet", "MCA_Loan_tenure", "MCA_EDI_basis_tenure", "PL_Collxn_Lender_Name", "frequent_traveller_rank", "ARPU_CLTV_L12M", "AFFLUENCE_SCORE", "foodie_rank", "Future_CLTV_N12M", "trust_rank", "convenience_oriented_rank", "budget_conscious_rank", "marketing_engagement_rank", "health_spenders_rank", "games_entertainment_rank", "risk_rank", "BANK_UPI_Lite_Status", "rent_promo_dropoff", "tuition_promo_dropoff", "Last_CIR_Pulled_date", "CONSUMERLENDING_postpaid_overall_cashback", "CONSUMERLENDING_postpaid_overall_points", "MCA_Whatsapp_Sent", "offer25apr", "App_Sessions_Count_7_days", "App_Sessions_Count_30_days", "4th_cat", "4th_cat_lc", "PFCC_SBI_HDFC_Carded_date", "PFCC_SBI_HDFC_Variant", "PFCC_SBI_HDFC_Activation_date", "merchant_signup_date_new", "PAYTMFIRST_plan_id_new", "paytm_total_days_transacted_count_30_days", "MCA_WL_Status", "paytm_total_active_days_count_30_days", "CONSUMERLENDING_PL_Lender_Name", "Loyalty_Tier", "Referral_total_attempted_count", "appsflyer_id", "firebase_id", "advertisementId", "clientId", "Amount_Refund_CCBP", "Payment starting month_CCBP", "Payment ending month_CCBP", "refund_txn_count_CCBP", "Consumer_lending_CL-PP_june_cf", "RU_Prepaid_Propensity_Score", "MCA_Signatory_Name", "offer_end_date", "offer_amt_postpaid_90_days", "CC_Tier", "PFCC_SBI_HDFC_Spends", "CONSUMERLENDING_PL_Disbursal_Date", "PromoEmail_Reachability_Paytm", "MCA_offer_expiry_countdown", "CONSUMERLENDING_postpaid_is_eligible_for_Rent", "Device_binding_status", "CONSUMERLENDING_pp_reset_leads_date", "MCA_WL_subtype", "ccbp_myntra_promocode", "ccbp_myntra_cp", "PFCC_Product_Variant_New", "PFCC_Propensity_New", "PFCC_Banking_Segment_New", "MCA_Dynamic_Offer", "Total_Successful_Referral_Count_MTD", "experian_lending_category_CIR_Base", "pp_max_offer", "loyalty_tier_new", "consumerlending_substage", "pfcc_whitelist_type_new", "loyalty_tier_p1", "rt1_date", "txn_count_in_stage", "loyalty_tier_latest", "Rupay_beta_cashback", "welcome_benefits_bought", "device_binding_status_new", "consumerlending_postpaid_last_transaction_date", "referral_contactbook_top_name", "referral_contactbook_count", "whatsapp_notification_received_last_date", "realtime_state", "realtime_geohash", "realtime_city", "MCA_Retarget", "PL_Repeat_Cohorts", "MCA_Push_Layering", "cbpoints_expiring_current_month", "International_User", "paytm_push_reachability_new", "MCA_Dynamic_Banner_New", "experian_lending_category", "promotion_loyalty_cashback_points_yesterday", "Rent_Whitelist_20th Nov", "MTG_Geohash_Paytm_Nov", "cp_boatstonebeam_promocode_29_Nov", "cp_giva_promocode_23_Nov", "Rent_Date_Test3", "pg_txn_users_30days", "next_metro_ticket_stations", "pml_ir_status", "consumerlending_pl_user_substage", "pml_eq_first_investment_date", "consumerlending_postpaid_upi_autopay_flag", "promotion_loyalty_cashback_points_last_month", "promotion_loyalty_cashback_points_7_days", "jackpot_winner_27_dec", "promocode_27_dec", "Rent_Date_Test4", "consumerlending_pl_user_lender_wl"};
            String[] evtlist = {"UTM Visited", "App Launched", "Notification Viewed", "App Uninstalled", "App Installed", "Notification Clicked", "Push Impressions", "Notification Delivered", "Notification Replied", "Reply Sent", "Identity Set", "Identity Error", "Identity Reset", "Experiment Rendered", "App Version Changed", "Reachable By", "Channel Unsubscribed", "Geocluster Entered", "Geocluster Exited", "AB Experiment Rendered", "AB Experiment Disqualified", "AB Experiment Rolled Out", "AB Experiment Stopped", "Session Concluded", "State Transitioned", "Partner Sync", "Web Session Started", "Notification Sent", "Signup Completed", "UPI First Transaction Completed", "MPIN Set", "Bank Account Linked", "UPI Request", "UPI Referral", "Device History", "Online Transaction Completed", "UPI Third Party Transaction Completed", "Utility Transaction Completed", "Offline Transaction Completed", "Push Sent", "Overall Transaction failed", "Bill Generated Event", "Bill Payment", "User Email Updated", "Postpaid", "Paytm Wallet", "Add to Cart", "Checkout Cart", "Product Wishlist", "Dismiss Event", "Stage Classifier Event", "UPI Transaction", "Bank Fixed Deposit", "Bank Beneficiary", "Bank Savings Account", "KYC", "Bank Balance Check", "Travel Bus", "UPI Not Linked", "Recharge Complete", "Qualify User On Pull", "Product Impression", "Product Detail", "Paytm Personal Loan", "Paytm First Card", "UPI Onboarding Available", "UPI Onboarding SMS", "UPI Onboarding Device", "Fastag PDP", "Fastag Success", "Paytm First", "Marketplace Sales Order", "Fastag", "Movie Booking Opening", "UPI_REQUEST", "PML Company Clicked", "PML Trade Buy Order Summary", "PML Add Stocks", "KYC Document Submitted", "Min KYC profile", "PML Make Payment Clicked", "PML Invest Now Clicked", "KYC Document Verification", "PML Proceed To Payment Clicked", "PML Stocks Onboarding Clicked", "Basic Plus KYC Landing", "PML Search Bar Clicked", "PML Watchlist Selected", "Video KYC", "Personal Loan Hero", "Paytm First Games", "Overall Order Update", "PPBL Debit Card Drop Off", "Automatic Add Money Setup", "User Login Record", "FASTag_CloseReq_Clicked", "FASTAG_VRN_Entered", "Train Summary Received", "Train Status Checked", "Train Traveller Details Filled", "Train Review Completed", "Train Order Page Viewed", "Train IRCTC Opened", "Train PNR Checked", "Merchant QR", "Fastag Bill Generation Event", "Fastag Bill Payment Event", "Train Homepage Landed", "FASTag disablement CLM Notification Pending Dues", "Product Impressions on PDP Page", "Paytm Postpaid Bill Reminder", "FASTag disablement CLM Notification Threshold Breach", "Train Searched", "Movie Event", "REFEREE ONBOARDED", "REFERRER ASSOCIATION CREATED", "MiniApp Payment Failed", "MiniApp Login bridge consent denied", "Product Impressions on List Page", "Product Impressions on StoreFront", "Banner Impression", "Banner Click", "Push Delivered", "LENDING PREFERENCE", "CDO INSURANCE MOTOR", "Event to test versioning v2", "Checkout Complete", "SSM DIY ONLINE PRELIVE", "Insurance RT Event", "PP PL MCA Collection Event", "Points Redeemed Non Paytm GV", "Points Insufficient Points Error", "Points clicked No On Confirmation Pop Up", "Points Catalog Opened", "Movie User Transaction", "CDO INSURANCE GROUP ATTACHMENT", "Automatic Add Money Creation Events", "Set Mpin Event", "Paytm Business App", "Brand Voucher Viewed", "Voucher Copy Code Clicked", "Voucher Redeem Now Clicked", "Brand EMI EDC", "Latency Test", "UPITransactionExperiment", "Recharge Event", "Summary Rent Payment Postpaid", "Summary Page Loaded Payment Success", "Summary Rent Payment Underscore Postpaid", "Landlord Details Screen Loaded", "Amount Screen Loaded", "Summary Rent Payment Space Postpaid", "SSM DIY Generate Test Keys", "Life Insurance Prequote Page", "Digital Gold Event", "Life Insurance Quote Page", "Life Insurance Product Details Page", "Mall Orders", "Citybus Page Visit", "Summary Page", "Select City", "Citybus Transaction Success", "Install", "RU Reminder Events", "Citybus Transaction Pending", "Amount Field Entered", "Operator Selected", "Cylinder CLP", "Cylinder Amount Field Entered", "KYC Rejected Pending Event", "Summary Page Rent", "Paytm First Membership", "Movies UpcomingMovie Event", "Notification Reco Event", "Paytm Personal Loan V3", "Dropdown Operator Selected", "RU Electricity Bill Payment Flow", "Deals Pay Bill Viewed", "Paytm Payment Preference Updated", "DIY Merchant OE Lead Created", "DIY Merchant Login", "DIY Merchant Upgrade Solution", "DIY Merchant Activate Account for Website App", "DIY Merchant Landed On Instant Onboarding", "O2OC Flights Upcoming Flight", "Deals Post Order Viewed", "DIY Merchant Explore Online Payments", "SSM DIY ONLINE INDIGO", "Paytm Global Consent", "Vaccine Certificate Download Page dropout", "Vaccine Certificate Download Page Landed", "Paytm Health ID Dropout", "Deals MDP Viewed", "Upload Document on Digilocker Page dropout", "Upload Documents on Digilocker", "Vaccine Slot dropout", "Paytm Health ID Created", "Booked Vaccine Slot", "User lands on landing screen", "User clicks on Proceed to Pay", "User lands on Policy Page", "User lands on Sucess Order Summary Page", "Mini Apps Visitors", "Paytm Reactivation", "Gift Cards Purchased", "Merchant Game Activation", "Signup new Topic Test", "RU Rent Payment Flow", "Gift Cards Post Order", "Equity Onboarding Hybrid", "Equity Onboarding Native", "Add Funds First Time", "Equity Onboarding MF", "Paytm Stocks Onboarding", "Paytm Mini Onboarding", "RU Telecom Prepaid Recharge", "RU Telecom Postpaid Recharge", "FASTag RC missing", "Paytm Lending MCA", "DTH user drop off feedback", "Deals Claim Events", "Add Money Drop Off", "Bank Inward Remittance", "Paytm Offer Activated", "CDO Insurance Health", "RU Tuition Fees Payment Flow", "RU Loan Payment Flow", "RU Electricity Chat", "Auto Add Money Renewal", "PCW User Joined Game", "RU DTH Recharge", "Referral Landing Page", "Referral Via Page", "RU CCBP Flow", "Paytm Money Referral", "SBI Card Onboarding", "HDFC Card Onboarding", "RU Apartment Event", "Loan Accounts Page in CIR", "CIR Loan Accounts", "Credit Card Bill Payments", "RU Insurance Premium", "Overdue Credit Card Payments", "Credit Card Payments", "Bus Journey", "Flights Journey", "PML Backend Event", "Deals BE Claim Events", "UPI MT Combination Cases", "UPI Welcome Push Event", "User Activated Campaign", "UPI LITE Landing Page Event", "Points PDP Opened", "Paytm Deals Landing Event", "Paytm Cricket League Event", "PPBL Profile Details Updated", "RU Education Fees Payment", "UPI Mapper Landing Page", "Gift Cards Storefront", "RU Fastag event", "Paytm SMS Scan Approved", "Lending Risk Offers", "ONDC Event", "Paytm Wallet Journey Event", "UPI Transaction Signal", "Paytm Promo Campaign", "WALLET", "PPBL Unfreeze Page Drop Off", "Paytm Referral Scroll Contact List", "RU Landline Event", "RU Cylinder Booking Payment", "Paytm Postpaid Txn Security Shield", "UPI Post Transaction SF Call", "Flights Home New", "Flights Search New", "Flights Review New", "Flights Traveler Details New", "Flights Final Review New", "Bus Search New", "Bus Seat New", "Bus Review New", "Bus Passenger New", "Metro QR Transaction Success", "PML Trading ideas page", "Metro QR Remainder Dismiss", "PML Growth Nudges", "Loyalty SF Open", "Scan And Pay Reminder Event", "PML MF SIP Event", "Postpaid Account Creation"};
            JSONArray array = new JSONArray(loadJSONFromAsset(context, uri));

            JSONArray result = new JSONArray();

            for (int i = 0; i < array.length(); i++) {
                String str = array.getJSONObject(i).toString();
                JSONObject item = new JSONObject();
                item.put("id", array.getJSONObject(i).getInt("_id"));
                item.put("Created By", array.getJSONObject(i).getString("c-by"));
                item.put("Updated By", array.getJSONObject(i).getString("u-by"));
                item.put("name", array.getJSONObject(i).getString("name"));
                item.put("jid", array.getJSONObject(i).has("jid")?array.getJSONObject(i).getInt("jid"):0);
                item.put("type", array.getJSONObject(i).getInt("type"));

                ArrayList<String> properties = new ArrayList<>();
                for (String s : list) {
                    if (str.contains(s)) {
                        properties.add(s);
                    }
                }
                ArrayList<String> event = new ArrayList<>();

                for (String s : evtlist) {
                    if (str.contains(s)) {
                        event.add(s);
                    }
                }
                JSONArray jsArray = new JSONArray(properties);
                JSONArray jsArrayEvt = new JSONArray(event);

                item.put("props", jsArray );
                item.put("evt", jsArrayEvt );
                result.put(item);
            }

            File appSpecificInternalStorageDirectory = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOCUMENTS);

            File file = new File(appSpecificInternalStorageDirectory, "result.json");
            file.createNewFile();
            FileOutputStream fos = new FileOutputStream(file, false);
            fos.write(result.toString().getBytes());
            fos.close();
            Log.d( "Data",result.toString());
            Toast.makeText(context, "File processed", Toast.LENGTH_LONG).show();

        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public String loadJSONFromAsset(Context context, Uri uri) {
        String json = null;
        try {
            InputStream is = context.getContentResolver().openInputStream(uri);
            int size = is.available();
            byte[] buffer = new byte[size];
            is.read(buffer);
            is.close();
            json = new String(buffer, "UTF-8");
        } catch (Exception ex) {
            ex.printStackTrace();
            return null;
        }
        return json;
    }
}
